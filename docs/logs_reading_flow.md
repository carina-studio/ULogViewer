---
title: ULogViewer
---

# How Does ULogViewer Read and Parse Logs
In order to read and parse various type of logs, there is a special flow of reading and parsing logs in ULogViewer you may need to know before defining your own log profile.

![Logs reading and parsing flow](https://carina-studio.github.io/ULogViewer/Images/Log_Reading_Flow.png)


## Parts Included in Reading and Parsing Logs
### Underlying Log Data
This is the original source which provides raw log data outside from ULogViewer. It may be a file, a database or output of another program.

### Log Data Source
This is the first part of ULogViewer to read raw log data into ULogViewer. 
There are various type of ```Log Data Source``` in ULogViewer to handle different type of ```Underlying Log Data```.

```Log Data Source``` reads raw log data and transforms into multiple ```Raw Log Line``` which is represented as string no matter what type of raw log data is.
It is important to know what ```Raw Log Line``` will be generated by specific ```Log Data Source``` so that you can define how to parse these ```Raw Log Line``` into actual logs.

### Log Profile
There are lots of information in ```Log Profile``` and part of them are related to logs parsing. For ex, log patterns, timestamp format, etc.

### Log Reader
Takes ```Raw Log Line``` generated by ```Log Data Source``` then parse and convert to actual logs according to information provided by ```Log Profile```.


## Log Data Sources
### File
```File Log Data Source``` is the simplest type of ```Log Data Source``` which reads strings line by line from file directly. You can specify what encoding is used to read strings from file.

### Standard Output (stdout)
Launches a specific program and reads strings line by line in ```UTF-8``` from the standard output (stdout) of the program. 
You need to define the ```Command``` first in order to launch program and pass parameters. For ex, ```ipconfig /all``` (on Windows).
Further more, you can define extra commands which will be executed **BEFORE** or **AFTER** reading raw log data.

### HTTP/HTTPS
Sends HTTP/HTTPS request to specific URI and reads the response line by line. You can provide ```User Name``` and ```Password``` if login is needed for sending request.

### SQLite
Performs specific ```Query String``` (SQL command) and gets the result rows back. Because database result is not a set of strings, ```SQLite Log Data Source``` will transform the result into strings **COLUMN by COLUMN** and **ROW by ROW**. For ex, if the result is

Column1 | Column2 | Column3
--------|---------|--------
A       |B        |C
D       |E        |F

Then the transformation order will be:
1. A
2. B
3. C
4. D
5. E
6. F

For each column, ```SQLite Log Data Source``` will transform data to string according to the value type of column:

- If the type is ```String```, it will transform data into 3 or more lines:
  ```xml
  <ColumnName>
  Value encoded as XML string
  </ColumnName>
  ```
  
- If the type is ```Blob```, it will encode data to Base64 string and transform into 1 line:
  ```xml
  <ColumnName>Base64 encoded data</ColumnName>
  ```
  
- If the type is ```Timestamp```, it will transform into 1 line:
  ```xml
  <ColumnName>Timestamp whth format yyyy/MM/dd HH:mm:ss.ffffff</ColumnName>
  ```
  
- For other types, it will transform into 1 line:
  ```xml
  <ColumnName>Value</ColumnName>
  ```

Lets see a pratical example, if the database result is:

ID | Timestamp | Message
---|-----------|--------
1  | 1/1 10:08 | First message
2  | 1/1 10:09 | &lt;Second message&gt;

Then ```SQLite Log Data Source``` will generate the following 10 ```Raw Log Line```:

```xml
<ID>1</ID>
<Timestamp>2021/1/1 10:08:00.000000</Timestamp>
<Message>
First message
</Message>
<ID>2</ID>
<Timestamp>2021/1/1 10:09:00.000000</Timestamp>
<Message>
&lt;Second message&gt;
</Message>
```

### Windows Event Logs (Windows only)
Gets structured Windows Event Logs data from system and transform each Event Log to strings in the following format:

```xml
<Timestamp>Timestamp of log in yyyy/MM/dd HH:mm:ss format</Timestamp>
<EventId>Event ID</EventId>
<Level>Level character</Level>
<Source>Source of log encoded as XML string</Source>
<Message>
Message of log encoded as XML string
</Message>
```

For ```Level character```, please refer to the following table:

Character | Level
----------|------
e         |Error
f         |Failure
i         |Info
s         |Success
w         |Warn


## Parsing Information Defined in Log Profile
### Log Patterns
After knowing what ```Raw Log Line``` will be generated by ```Log Data Source```, you need to define ```Log Pattern``` to parse and extract information from ```Raw Log Line```.

Each ```Log Pattern``` is defined for specific single ```Raw Log Line```. 
If each log can be generated from single ```Raw Log Line``` then you just need one ```Log Pattern```.
If each log may generated by more than one ```Raw Log Line``` then you need to define multiple ```Log Pattern``` for each type of ```Raw Log Line``` in single log.

For example:
- If each log will be generated by ```Raw Log Line (Type 1)``` then you just need to define a ```Log Pattern``` for ```Raw Log Line (Type 1)```.
- If each log will be generated by 3 type of ```Raw Log Line```:
  - ```Raw Log Line (Type 1)```
  - ```Raw Log Line (Type 2)```
  - ```Raw Log Line (Type 3)```
  
  Then you need to define 3 ```Log Pattern```
  - ```Log Pattern 1``` for ```Raw Log Line (Type 1)```
  - ```Log Pattern 2``` for ```Raw Log Line (Type 2)```
  - ```Log Pattern 3``` for ```Raw Log Line (Type 3)```

There are 3 parameters in each ```Log Pattern```:
#### Pattern
  Decribe the string pattern of ```Raw Log Line``` by [**Regular Expression**](https://en.wikipedia.org/wiki/Regular_expression). Further more, you need to use [**Grouping Syntax/Construct**](https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference#grouping-constructs) to extract data from ```Raw Log Line``` for specific property of log. 
  There is a specific button in Log Pattern dialog which helps you to insert **Grouping Syntax** easily for specific log property.
  
  Please refer to [**here**](https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference) for complete reference of Regular Expression.

#### Is Repeatable
If the specifc type of ```Raw Log Line``` may occurrs more than one times continuously, then you can mark the ```Log Pattern``` as repeatable.

#### Is Skippable
If the specifc type of ```Raw Log Line``` may not occurr, then you can mark the ```Log Pattern``` as skippable.
Usually you need to take both **Is Repeatable** and **Is Skippable** into account according to the following conditions:

Cases             | Repeatable = False | Repeatable = True
------------------|--------------------|------------------
Skippable = False | ```Raw Log Line``` should occur exact 1 time   | ```Raw Log Line``` should occur at least 1 time continuously
Skippable = True  | ```Raw Log Line``` should occur at most 1 time | ```Raw Log Line``` should not occur or occur continuously

### Log Level Map
If information of ```Level``` of log has been extracted from ```Raw Log Line``` by ```Log Pattern```, we need a table to describe how to convert from ```String``` to ```Level``` of log.

For example, if valid set of ```Level``` of log is ```{ Success, Failure }``` and you know that 'S' means ```Success``` and 'F' means ```Failure``` in ``` Raw Log Line```, then you need to provide the following ```Log Level Map```:

Text | Mapped Level
-----|-------------
F    | Failure
S    | Success

### Log String Encoding
Consider the format of ```Raw Log Line```, the data in ```Raw Log Line``` may be encoded in specific way to prevent conflict with the format. 
For example, ```Raw Log Line``` generated by ```SQLite Log Data Source``` is XML-like format, so the value inside ```Raw Log Line``` will be encoded as XML/HTML string.

### Timestamp format
The format of timestamp of log extracted from ```Raw Log Line``` varies between different type of logs. If you found that ULogViewer cannot parse the timestamp correctly by default way, you can provide the exact format to parse timestamp correctly.

Please refer to [**here**](https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings) for complete reference of date time format.


<br/>ðŸ“”[Back to Home](index.md)
